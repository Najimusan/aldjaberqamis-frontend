(()=>{var e={};e.id=101,e.ids=[101],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},9803:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var a=s(3528);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8626:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var a=s(3528);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},7738:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>o,routeModule:()=>u,tree:()=>d});var a=s(7096),r=s(6132),l=s(7284),i=s.n(l),n=s(2564),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);s.d(t,c);let d=["",{children:["admin",{children:["commandes",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1274)),"C:\\Users\\nazim\\Desktop\\aldjaberqamis\\aldjaberqamis-frontend\\app\\admin\\commandes\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,2458)),"C:\\Users\\nazim\\Desktop\\aldjaberqamis\\aldjaberqamis-frontend\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,3304)),"C:\\Users\\nazim\\Desktop\\aldjaberqamis\\aldjaberqamis-frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],o=["C:\\Users\\nazim\\Desktop\\aldjaberqamis\\aldjaberqamis-frontend\\app\\admin\\commandes\\page.tsx"],x="/admin/commandes/page",m={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/commandes/page",pathname:"/admin/commandes",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9285:(e,t,s)=>{Promise.resolve().then(s.bind(s,8326))},8326:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var a=s(784),r=s(9885),l=s(7114),i=s(4571),n=s(9803),c=s(7004),d=s(9518),o=s(8626),x=s(6303),m=s(345);let __WEBPACK_DEFAULT_EXPORT__=()=>{let[e,t]=(0,r.useState)([]),[s,u]=(0,r.useState)(!0),[p,h]=(0,r.useState)(""),[g,j]=(0,r.useState)(""),[y,f]=(0,r.useState)(1),[v,N]=(0,r.useState)(1),[b,w]=(0,r.useState)(null),[_,C]=(0,r.useState)(null),[k,q]=(0,r.useState)(!1),P=(0,l.useRouter)(),E=[{value:"en attente",label:"En attente",color:"text-yellow-400"},{value:"confirm\xe9",label:"Confirm\xe9",color:"text-green-400"},{value:"exp\xe9di\xe9e",label:"Exp\xe9di\xe9e",color:"text-purple-400"},{value:"livr\xe9e",label:"Livr\xe9e",color:"text-emerald-400"},{value:"annul\xe9e",label:"Annul\xe9e",color:"text-red-400"}];(0,r.useEffect)(()=>{let e=localStorage.getItem("adminToken");if(!e){P.push("/admin/login");return}fetch("http://localhost:5000/api/auth/verify",{headers:{Authorization:`Bearer ${e}`}}).then(e=>e.json()).then(t=>{if(!["super_admin","admin","manager"].includes(t.data.user.role)){P.push("/admin/dashboard");return}w(e),fetchOrders(e)}).catch(()=>{localStorage.removeItem("adminToken"),P.push("/admin/login")})},[p,g,y,P]);let fetchOrders=async e=>{try{u(!0);let s=new URLSearchParams({page:y.toString(),limit:"10"});p&&s.append("search",p),g&&s.append("status",g);let a=e||b;console.log("Token utilis\xe9:",a),console.log("URL appel\xe9e:",`http://localhost:5000/api/orders?${s}`);let r=await fetch(`http://localhost:5000/api/orders?${s}`,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(console.log("R\xe9ponse status:",r.status),r.ok){let e=await r.json();console.log("Commandes admin charg\xe9es:",e),t(e.data||[]),N(e.pagination?.totalPages||1)}else{let e=await r.json();console.error("Erreur API:",e)}}catch(e){console.error("Erreur lors du chargement des commandes:",e)}finally{u(!1)}},updateOrderStatus=async(s,a)=>{try{let r=await fetch(`http://localhost:5000/api/orders/${s}/status`,{method:"PATCH",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({status:a})});if(r.ok){let a=await r.json();a.data.deleted?(t(e.filter(e=>e._id!==s)),m.default.success(a.message)):(fetchOrders(b),m.default.success("Statut mis \xe0 jour avec succ\xe8s"))}else{let e=await r.json();m.default.error(e.message||"Erreur lors de la mise \xe0 jour")}}catch(e){console.error("Erreur lors de la mise \xe0 jour du statut:",e),m.default.error("Erreur lors de la mise \xe0 jour du statut")}},deleteOrder=async s=>{if(confirm("\xcates-vous s\xfbr de vouloir supprimer cette commande ?"))try{let a=await fetch(`http://localhost:5000/api/orders/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${b}`}});if(a.ok)t(e.filter(e=>e._id!==s)),m.default.success("Commande supprim\xe9e avec succ\xe8s");else{let e=await a.json();m.default.error(e.message||"Erreur lors de la suppression")}}catch(e){console.error("Erreur lors de la suppression:",e),m.default.error("Erreur lors de la suppression")}},openDetailsModal=e=>{C(e),q(!0)},closeDetailsModal=()=>{C(null),q(!1)},getStatusColor=e=>{let t=E.find(t=>t.value===e);return t?.color||"text-gray-400"},formatPrice=e=>new Intl.NumberFormat("fr-DZ",{style:"currency",currency:"DZD"}).format(e);return b?(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("div",{className:"flex items-center space-x-3",children:(0,a.jsxs)(i.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>P.push("/admin/dashboard"),className:"flex items-center space-x-2 text-gray-300 hover:text-white transition-colors",children:[a.jsx(n.Z,{className:"w-5 h-5"}),a.jsx("span",{children:"Retour au Dashboard"})]})}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx(c.Z,{className:"w-8 h-8 text-white"}),a.jsx("h1",{className:"text-2xl font-bold text-white",children:"Gestion des Commandes"})]}),a.jsx("div",{})]}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[a.jsx(d.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Rechercher une commande...",value:p,onChange:e=>h(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-white focus:border-transparent"})]}),(0,a.jsxs)("select",{value:g,onChange:e=>j(e.target.value),className:"px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white focus:border-transparent",children:[a.jsx("option",{value:"",children:"Tous les statuts"}),E.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))]}),(0,a.jsxs)("button",{onClick:()=>fetchOrders(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[a.jsx(d.Z,{className:"w-4 h-4"}),a.jsx("span",{children:"Actualiser"})]})]}),a.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:s?a.jsx("div",{className:"p-8 text-center text-gray-400",children:"Chargement des commandes..."}):a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-700",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Commande"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Client"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Livraison"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Articles"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Montant"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Statut"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-700",children:e.map(e=>(0,a.jsxs)(i.E.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"hover:bg-gray-700 transition-colors",children:[(0,a.jsxs)("td",{className:"px-4 py-4 whitespace-nowrap",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-white",children:["#",e.orderNumber]}),(0,a.jsxs)("div",{className:"text-xs text-gray-400",children:["ID: ",e._id.slice(-8)]})]}),(0,a.jsxs)("td",{className:"px-4 py-4 whitespace-nowrap",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-white",children:[e.customer.firstName," ",e.customer.lastName]}),(0,a.jsxs)("div",{className:"text-xs text-gray-400",children:["\uD83D\uDCDE ",e.customer.phone]})]}),(0,a.jsxs)("td",{className:"px-4 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm text-white",children:e.delivery.address}),(0,a.jsxs)("div",{className:"text-xs text-gray-400",children:[e.delivery.city,", ",e.delivery.wilaya," ",e.delivery.postalCode]})]}),(0,a.jsxs)("td",{className:"px-4 py-4 whitespace-nowrap",children:[(0,a.jsxs)("div",{className:"text-sm text-white",children:[e.items.length," article(s)"]}),a.jsx("div",{className:"text-xs text-gray-400",children:e.items.map(e=>`${e.quantity}x ${e.product?.name||"Produit supprim\xe9"}`).join(", ")})]}),(0,a.jsxs)("td",{className:"px-4 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm font-medium text-white",children:formatPrice(e.total)}),(0,a.jsxs)("div",{className:"text-xs text-gray-400",children:["Sous-total: ",formatPrice(e.subtotal),(e.shippingCost||0)>0&&(0,a.jsxs)("span",{children:[" + Livraison: ",formatPrice(e.shippingCost||0)]})]})]}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:a.jsx("select",{value:e.status,onChange:t=>updateOrderStatus(e._id,t.target.value),className:`text-xs font-medium px-2 py-1 rounded-full border-0 bg-transparent ${getStatusColor(e.status)}`,children:E.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})}),(0,a.jsxs)("td",{className:"px-4 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm text-gray-400",children:new Date(e.createdAt).toLocaleDateString("fr-FR")}),a.jsx("div",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleTimeString("fr-FR")})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[a.jsx(i.E.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>openDetailsModal(e),className:"text-blue-400 hover:text-blue-300",title:"Voir les d\xe9tails",children:a.jsx(o.Z,{className:"w-4 h-4"})}),a.jsx(i.E.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>deleteOrder(e._id),className:"text-red-400 hover:text-red-300",title:"Supprimer la commande",children:a.jsx(x.Z,{className:"w-4 h-4"})})]})})]},e._id))})]})})}),v>1&&(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2 mt-6",children:[a.jsx("button",{onClick:()=>f(e=>Math.max(e-1,1)),disabled:1===y,className:"px-3 py-2 bg-gray-700 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-600",children:"Pr\xe9c\xe9dent"}),(0,a.jsxs)("span",{className:"px-4 py-2 text-white",children:["Page ",y," sur ",v]}),a.jsx("button",{onClick:()=>f(e=>Math.min(e+1,v)),disabled:y===v,className:"px-3 py-2 bg-gray-700 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-600",children:"Suivant"})]}),k&&_&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx(i.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-gray-800 rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-white",children:["D\xe9tails de la commande #",_.orderNumber]}),a.jsx("button",{onClick:closeDetailsModal,className:"text-gray-400 hover:text-white text-2xl",children:"\xd7"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"bg-gray-700 p-4 rounded-lg",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Informations Client"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("p",{className:"text-gray-300",children:[a.jsx("span",{className:"font-medium text-white",children:"Nom:"})," ",_.customer.firstName," ",_.customer.lastName]}),(0,a.jsxs)("p",{className:"text-gray-300",children:[a.jsx("span",{className:"font-medium text-white",children:"T\xe9l\xe9phone:"})," ",_.customer.phone]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-700 p-4 rounded-lg",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Adresse de Livraison"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("p",{className:"text-gray-300",children:[a.jsx("span",{className:"font-medium text-white",children:"Adresse:"})," ",_.delivery.address]}),(0,a.jsxs)("p",{className:"text-gray-300",children:[a.jsx("span",{className:"font-medium text-white",children:"Ville:"})," ",_.delivery.city]}),(0,a.jsxs)("p",{className:"text-gray-300",children:[a.jsx("span",{className:"font-medium text-white",children:"Wilaya:"})," ",_.delivery.wilaya]}),(0,a.jsxs)("p",{className:"text-gray-300",children:[a.jsx("span",{className:"font-medium text-white",children:"Code postal:"})," ",_.delivery.postalCode]}),_.delivery.notes&&(0,a.jsxs)("p",{className:"text-gray-300",children:[a.jsx("span",{className:"font-medium text-white",children:"Notes:"})," ",_.delivery.notes]})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-700 p-4 rounded-lg mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Articles Command\xe9s"}),a.jsx("div",{className:"space-y-3",children:_.items.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between bg-gray-600 p-3 rounded",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-white font-medium",children:e.product?.name||"Produit supprim\xe9"}),(0,a.jsxs)("p",{className:"text-gray-400 text-sm",children:["Taille: ",e.selectedSize," | Couleur: ",e.selectedColor]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-white",children:["Quantit\xe9: ",e.quantity]}),(0,a.jsxs)("p",{className:"text-gray-400",children:[formatPrice(e.product.price)," \xd7 ",e.quantity]})]})]},t))})]}),(0,a.jsxs)("div",{className:"bg-gray-700 p-4 rounded-lg",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"R\xe9sum\xe9 Financier"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-300",children:"Sous-total:"}),a.jsx("span",{className:"text-white",children:formatPrice(_.subtotal)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-300",children:"Livraison:"}),a.jsx("span",{className:"text-white",children:_.shippingCost&&_.shippingCost>0?formatPrice(_.shippingCost):"Gratuite"})]}),(0,a.jsxs)("div",{className:"flex justify-between text-lg font-semibold border-t border-gray-600 pt-2",children:[a.jsx("span",{className:"text-white",children:"Total:"}),a.jsx("span",{className:"text-white",children:formatPrice(_.total)})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[a.jsx("button",{onClick:closeDetailsModal,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-500",children:"Fermer"}),a.jsx("select",{value:_.status,onChange:e=>{updateOrderStatus(_._id,e.target.value),C({..._,status:e.target.value})},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:E.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]})]})})})]}):null}},1274:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>l,default:()=>c});var a=s(5153);let r=(0,a.createProxy)(String.raw`C:\Users\nazim\Desktop\aldjaberqamis\aldjaberqamis-frontend\app\admin\commandes\page.tsx`),{__esModule:l,$$typeof:i}=r,n=r.default,c=n}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[980,357,626,684,245,167],()=>__webpack_exec__(7738));module.exports=s})();