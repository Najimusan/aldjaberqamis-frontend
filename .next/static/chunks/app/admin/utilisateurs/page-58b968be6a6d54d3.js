(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{3067:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(2898).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},9617:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(2898).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},9883:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(2898).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},1827:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(2898).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},1138:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(2898).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},5750:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(2898).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},2087:function(e,t,a){Promise.resolve().then(a.bind(a,2311))},2311:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var s=a(7437),r=a(2265),l=a(4033),i=a(5251),n=a(3067),o=a(5750),c=a(9883),d=a(1827),u=a(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,u.Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),h=(0,u.Z)("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);var p=a(9617),m=a(1138),f=e=>{let{token:t,onBackToDashboard:a}=e,[l,u]=(0,r.useState)([]),[f,y]=(0,r.useState)(!0),[g,v]=(0,r.useState)(""),[b,j]=(0,r.useState)(""),[N,w]=(0,r.useState)(!1),[k,C]=(0,r.useState)(null),[S,Z]=(0,r.useState)(1),[E,M]=(0,r.useState)(1),[T,A]=(0,r.useState)({username:"",password:"",role:"manager",profile:{firstName:"",lastName:""}}),_=[{value:"admin",label:"Admin",color:"text-orange-400"},{value:"manager",label:"Manager",color:"text-blue-400"}];(0,r.useEffect)(()=>{P()},[g,b,S]);let P=async()=>{try{y(!0);let e=new URLSearchParams({page:S.toString(),limit:"10"});g&&e.append("search",g),b&&e.append("role",b);let a=await fetch("http://localhost:5000/api/users?".concat(e),{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});if(a.ok){let e=await a.json();u(e.users),M(e.totalPages)}}catch(e){console.error("Erreur lors du chargement des utilisateurs:",e)}finally{y(!1)}},z=async e=>{e.preventDefault();try{(await fetch("http://localhost:5000/api/users",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(T)})).ok&&(w(!1),A({username:"",password:"",role:"client",profile:{firstName:"",lastName:""}}),P())}catch(e){console.error("Erreur lors de la cr\xe9ation:",e)}},H=async e=>{if(e.preventDefault(),k)try{(await fetch("http://localhost:5000/api/users/".concat(k._id),{method:"PUT",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(T)})).ok&&(C(null),A({username:"",password:"",role:"client",profile:{firstName:"",lastName:""}}),P())}catch(e){console.error("Erreur lors de la modification:",e)}},U=async e=>{if(confirm("\xcates-vous s\xfbr de vouloir supprimer cet utilisateur ?"))try{(await fetch("http://localhost:5000/api/users/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}})).ok&&P()}catch(e){console.error("Erreur lors de la suppression:",e)}},q=async(e,a)=>{try{(await fetch("http://localhost:5000/api/users/".concat(e),{method:"PUT",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({isActive:!a})})).ok&&P()}catch(e){console.error("Erreur lors du changement de statut:",e)}},D=e=>{var t,a;C(e),A({username:e.username,password:"",role:e.role,profile:{firstName:(null===(t=e.profile)||void 0===t?void 0:t.firstName)||"",lastName:(null===(a=e.profile)||void 0===a?void 0:a.lastName)||""}})},B=e=>{let t=_.find(t=>t.value===e);return(null==t?void 0:t.color)||"text-gray-400"},L=e=>{let t=_.find(t=>t.value===e);return(null==t?void 0:t.label)||e};return(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)("div",{className:"flex items-center space-x-3",children:a&&(0,s.jsxs)(i.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:a,className:"flex items-center space-x-2 text-gray-300 hover:text-white transition-colors",children:[(0,s.jsx)(n.Z,{className:"w-5 h-5"}),(0,s.jsx)("span",{children:"Retour au Dashboard"})]})}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(o.Z,{className:"w-8 h-8 text-white"}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Gestion des Utilisateurs"})]}),(0,s.jsxs)(i.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>w(!0),className:"flex items-center space-x-2 bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors",children:[(0,s.jsx)(c.Z,{className:"w-5 h-5"}),(0,s.jsx)("span",{children:"Nouvel Utilisateur"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)(d.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,s.jsx)("input",{type:"text",placeholder:"Rechercher un utilisateur...",value:g,onChange:e=>v(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-white focus:border-transparent"})]}),(0,s.jsxs)("select",{value:b,onChange:e=>j(e.target.value),className:"px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Tous les r\xf4les"}),_.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,s.jsx)("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:f?(0,s.jsx)("div",{className:"p-8 text-center text-gray-400",children:"Chargement des utilisateurs..."}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{className:"bg-gray-700",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Utilisateur"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"R\xf4le"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Statut"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Date de cr\xe9ation"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-700",children:l.map(e=>{var t,a,r,l;return(0,s.jsxs)(i.E.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"hover:bg-gray-700 transition-colors",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,s.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-600 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-sm font-medium text-white",children:(null===(a=e.profile)||void 0===a?void 0:null===(t=a.firstName)||void 0===t?void 0:t[0])||e.username[0].toUpperCase()})})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-white",children:(null===(r=e.profile)||void 0===r?void 0:r.firstName)&&(null===(l=e.profile)||void 0===l?void 0:l.lastName)?"".concat(e.profile.firstName," ").concat(e.profile.lastName):e.username}),(0,s.jsxs)("div",{className:"text-sm text-gray-400",children:["@",e.username]})]})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(B(e.role)),children:L(e.role)})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("button",{onClick:()=>q(e._id,e.isActive),className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat(e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.isActive?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x,{className:"w-3 h-3 mr-1"}),"Actif"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h,{className:"w-3 h-3 mr-1"}),"Inactif"]})})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-400",children:new Date(e.createdAt).toLocaleDateString("fr-FR")}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[(0,s.jsx)(i.E.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>D(e),className:"text-blue-400 hover:text-blue-300",children:(0,s.jsx)(p.Z,{className:"w-4 h-4"})}),"super_admin"!==e.role?(0,s.jsx)(i.E.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>U(e._id),className:"text-red-400 hover:text-red-300",children:(0,s.jsx)(m.Z,{className:"w-4 h-4"})}):(0,s.jsx)(i.E.button,{disabled:!0,className:"text-gray-500 cursor-not-allowed opacity-50",title:"Le Super Admin ne peut pas \xeatre supprim\xe9",children:(0,s.jsx)(m.Z,{className:"w-4 h-4"})})]})})]},e._id)})})]})})}),E>1&&(0,s.jsxs)("div",{className:"flex items-center justify-center space-x-2 mt-6",children:[(0,s.jsx)("button",{onClick:()=>Z(e=>Math.max(e-1,1)),disabled:1===S,className:"px-3 py-2 bg-gray-700 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-600",children:"Pr\xe9c\xe9dent"}),(0,s.jsxs)("span",{className:"px-4 py-2 text-white",children:["Page ",S," sur ",E]}),(0,s.jsx)("button",{onClick:()=>Z(e=>Math.min(e+1,E)),disabled:S===E,className:"px-3 py-2 bg-gray-700 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-600",children:"Suivant"})]}),(N||k)&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)(i.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-gray-800 p-6 rounded-lg w-full max-w-md mx-4",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-white mb-4",children:k?"Modifier l'utilisateur":"Nouvel utilisateur"}),(0,s.jsxs)("form",{onSubmit:k?H:z,children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Nom d'utilisateur"}),(0,s.jsx)("input",{type:"text",value:T.username,onChange:e=>A({...T,username:e.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Mot de passe ",k&&"(laisser vide pour ne pas changer)"]}),(0,s.jsx)("input",{type:"password",value:T.password,onChange:e=>A({...T,password:e.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white",required:!k})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"R\xf4le"}),(0,s.jsx)("select",{value:T.role,onChange:e=>A({...T,role:e.target.value}),disabled:(null==k?void 0:k.role)==="super_admin",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white ".concat((null==k?void 0:k.role)==="super_admin"?"opacity-50 cursor-not-allowed":""),children:_.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))}),(null==k?void 0:k.role)==="super_admin"&&(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Le r\xf4le Super Admin ne peut pas \xeatre modifi\xe9"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Pr\xe9nom"}),(0,s.jsx)("input",{type:"text",value:T.profile.firstName,onChange:e=>A({...T,profile:{...T.profile,firstName:e.target.value}}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Nom"}),(0,s.jsx)("input",{type:"text",value:T.profile.lastName,onChange:e=>A({...T,profile:{...T.profile,lastName:e.target.value}}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white"})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{w(!1),C(null),A({username:"",password:"",role:"manager",profile:{firstName:"",lastName:""}})},className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-500",children:"Annuler"}),(0,s.jsx)("button",{type:"submit",className:"px-4 py-2 bg-white text-black rounded-lg hover:bg-gray-200",children:k?"Modifier":"Cr\xe9er"})]})]})]})})]})},y=()=>{let[e,t]=(0,r.useState)(null),[a,i]=(0,r.useState)(!0),n=(0,l.useRouter)();return((0,r.useEffect)(()=>{let e=localStorage.getItem("adminToken");if(!e){n.push("/admin/login");return}fetch("http://localhost:5000/api/auth/verify",{headers:{Authorization:"Bearer ".concat(e)}}).then(e=>{if(e.ok)return e.json();throw Error("Token invalide")}).then(a=>{if("super_admin"!==a.data.user.role){n.push("/admin/dashboard");return}t(e)}).catch(()=>{localStorage.removeItem("adminToken"),n.push("/admin/login")}).finally(()=>{i(!1)})},[n]),a)?(0,s.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-white text-xl",children:"Chargement..."})}):e?(0,s.jsx)(f,{token:e,onBackToDashboard:()=>n.push("/admin/dashboard")}):null}},4033:function(e,t,a){e.exports=a(5313)}},function(e){e.O(0,[581,971,938,744],function(){return e(e.s=2087)}),_N_E=e.O()}]);